I wrote this code myself.
I believe everything works perfectly under all conditions.
